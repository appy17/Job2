(function(t){var e=window;if(!Object.keys){Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!({toString:null}).propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=a.length;return function(s){if(typeof s!=="object"&&(typeof s!=="function"||s===null)){throw new TypeError("Object.keys called on non-object")}var r=[],n,o;for(n in s){if(t.call(s,n)){r.push(n)}}if(e){for(o=0;o<i;o++){if(t.call(s,a[o])){r.push(a[o])}}}return r}}()}var a=false;var i=200;var s=location.hash==="#debug";function r(t){if(s){console.log(t)}}var n=["Days","Hours","Minutes","Seconds"];var o={Seconds:"Minutes",Minutes:"Hours",Hours:"Days",Days:"Years"};var f={Seconds:1,Minutes:60,Hours:3600,Days:86400,Months:2678400,Years:31536e3};function u(t){var e=/^rgba?\(([\d]+),([\d]+),([\d]+)(,([\d\.]+))?\)$/;if(e.test(t)){var a=e.exec(t);return{r:parseInt(a[1]),g:parseInt(a[2]),b:parseInt(a[3]),a:parseInt(a[5]?a[5]:1)}}var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(i,function(t,e,a,i){return e+e+a+a+i+i});var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function h(){var t=document.createElement("canvas");return!!(t.getContext&&t.getContext("2d"))}function d(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function l(){return d()+d()+"-"+d()+"-"+d()+"-"+d()+"-"+d()+d()+d()}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(t){var e=this.length>>>0;var a=Number(arguments[1])||0;a=a<0?Math.ceil(a):Math.floor(a);if(a<0)a+=e;for(;a<e;a++){if(a in this&&this[a]===t)return a}return-1}}function c(t){var e=t.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/);if(e!==null&&e.length>0){var a=t.split(" ");var i=a[0].split("-");var s=a[1].split(":");return new Date(i[0],i[1]-1,i[2],s[0],s[1],s[2])}var r=Date.parse(t);if(!isNaN(r))return r;r=Date.parse(t.replace(/-/g,"/").replace("T"," "));if(!isNaN(r))return r;return new Date}function m(t,e,a,i,s){var r={};var n={};var o={};var u={};var h={};var d={};var l=null;for(var c=0;c<i.length;c++){var m=i[c];var p;if(l===null){p=a/f[m]}else{p=f[l]/f[m]}var v=t/f[m];var _=e/f[m];if(s){if(v>0)v=Math.floor(v);else v=Math.ceil(v);if(_>0)_=Math.floor(_);else _=Math.ceil(_)}if(m!=="Days"){v=v%p;_=_%p}r[m]=v;o[m]=Math.abs(v);n[m]=_;d[m]=Math.abs(_);u[m]=Math.abs(v)/p;h[m]=Math.abs(_)/p;l=m}return{raw_time:r,raw_old_time:n,time:o,old_time:d,pct:u,old_pct:h}}var p={};function v(){if(typeof e.TC_Instance_List!=="undefined"){p=e.TC_Instance_List}else{e.TC_Instance_List=p}_(e)};function _(t){var e=["webkit","moz"];for(var a=0;a<e.length&&!t.requestAnimationFrame;++a){t.requestAnimationFrame=t[e[a]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[e[a]+"CancelAnimationFrame"]}if(!t.requestAnimationFrame||!t.cancelAnimationFrame){t.requestAnimationFrame=function(e,a,i){if(typeof i==="undefined")i={data:{last_frame:0}};var s=new Date().getTime();var r=Math.max(0,16-(s-i.data.last_frame));var n=t.setTimeout(function(){e(s+r)},r);i.data.last_frame=s+r;return n};t.cancelAnimationFrame=function(t){clearTimeout(t)}}};var b=function(t,e){this.element=t;this.container;this.listeners=null;this.data={paused:false,last_frame:0,animation_frame:null,interval_fallback:null,timer:false,total_duration:null,prev_time:null,drawn_units:[],text_elements:{Days:null,Hours:null,Minutes:null,Seconds:null},attributes:{canvas:null,context:null,item_size:null,line_width:null,radius:null,outer_radius:null},state:{fading:{Days:false,Hours:false,Minutes:false,Seconds:false}}};this.config=null;this.setOptions(e);this.initialize()};b.prototype.clearListeners=function(){this.listeners={all:[],visible:[]}};b.prototype.addTime=function(t){if(this.data.attributes.ref_date instanceof Date){var e=this.data.attributes.ref_date;e.setSeconds(e.getSeconds()+t)}else if(!isNaN(this.data.attributes.ref_date)){this.data.attributes.ref_date+=t*1e3}};b.prototype.initialize=function(i){this.data.drawn_units=[];for(var s=0;s<Object.keys(this.config.time).length;s++){var r=Object.keys(this.config.time)[s];if(this.config.time[r].show){this.data.drawn_units.push(r)}}t(this.element).children("div.time_circles").remove();if(typeof i==="undefined")i=true;if(i||this.listeners===null){this.clearListeners()}this.container=t("<div>");this.container.addClass("time_circles");this.container.appendTo(this.element);var n=this.element.offsetHeight;var o=this.element.offsetWidth;if(n===0)n=t(this.element).height();if(o===0)o=t(this.element).width();if(n===0&&o>0)n=o/this.data.drawn_units.length;else if(o===0&&n>0)o=n*this.data.drawn_units.length;var f=document.createElement("canvas");f.width=o;f.height=n;this.data.attributes.canvas=t(f);this.data.attributes.canvas.appendTo(this.container);var u=h();if(!u&&typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(f);a=true;u=true}if(u){this.data.attributes.context=f.getContext("2d")}this.data.attributes.item_size=Math.min(o/this.data.drawn_units.length,n);this.data.attributes.line_width=this.data.attributes.item_size*this.config.fg_width;this.data.attributes.radius=(this.data.attributes.item_size*.8-this.data.attributes.line_width)/2;this.data.attributes.outer_radius=this.data.attributes.radius+.5*Math.max(this.data.attributes.line_width,this.data.attributes.line_width*this.config.bg_width);var s=0;for(var d in this.data.text_elements){if(!this.config.time[d].show)continue;var l=t("<div>");l.addClass("textDiv_"+d);l.css("top",Math.round(.35*this.data.attributes.item_size));l.css("left",Math.round(s++*this.data.attributes.item_size));l.css("width",this.data.attributes.item_size);l.appendTo(this.container);var c=t("<span>");c.css("font-size",Math.round(this.config.number_size*this.data.attributes.item_size));c.appendTo(l);var m=t("<h4>");m.text(this.config.time[d].text);m.css("font-size",Math.round(this.config.text_size*this.data.attributes.item_size));m.appendTo(l);this.data.text_elements[d]=c}this.start();if(!this.config.start){this.data.paused=true}var p=this;this.data.interval_fallback=e.setInterval(function(){p.update.call(p,true)},100)};b.prototype.update=function(t){if(typeof t==="undefined"){t=false}else if(t&&this.data.paused){return}if(a){this.data.attributes.context.clearRect(0,0,this.data.attributes.canvas[0].width,this.data.attributes.canvas[0].hright)}var s,r;var o=this.data.prev_time;var u=new Date;this.data.prev_time=u;if(o===null)o=u;if(!this.config.count_past_zero){if(u>this.data.attributes.ref_date){for(var h=0;h<this.data.drawn_units.length;h++){var d=this.data.drawn_units[h];this.data.text_elements[d].text("0");var l=h*this.data.attributes.item_size+this.data.attributes.item_size/2;var c=this.data.attributes.item_size/2;var p=this.config.time[d].color;this.drawArc(l,c,p,0)}this.stop();return}}s=(this.data.attributes.ref_date-u)/1e3;r=(this.data.attributes.ref_date-o)/1e3;var v=this.config.animation!=="smooth";var _=m(s,r,this.data.total_duration,this.data.drawn_units,v);var b=m(s,r,f["Years"],n,v);var h=0;var g=0;var y=null;var w=this.data.drawn_units.slice();for(var h in n){var d=n[h];if(Math.floor(b.raw_time[d])!==Math.floor(b.raw_old_time[d])){this.notifyListeners(d,Math.floor(b.time[d]),Math.floor(s),"all")}if(w.indexOf(d)<0)continue;if(Math.floor(_.raw_time[d])!==Math.floor(_.raw_old_time[d])){this.notifyListeners(d,Math.floor(_.time[d]),Math.floor(s),"visible")}if(!t){this.data.text_elements[d].text(Math.floor(Math.abs(_.time[d])));var l=g*this.data.attributes.item_size+this.data.attributes.item_size/2;var c=this.data.attributes.item_size/2;var p=this.config.time[d].color;if(this.config.animation==="smooth"){if(y!==null&&!a){if(Math.floor(_.time[y])>Math.floor(_.old_time[y])){this.radialFade(l,c,p,1,d);this.data.state.fading[d]=true}else if(Math.floor(_.time[y])<Math.floor(_.old_time[y])){this.radialFade(l,c,p,0,d);this.data.state.fading[d]=true}}if(!this.data.state.fading[d]){this.drawArc(l,c,p,_.pct[d])}}else{this.animateArc(l,c,p,_.pct[d],_.old_pct[d],new Date().getTime()+i)}}y=d;g++}if(this.data.paused||t){return}var M=this;var x=function(){M.update.call(M)};if(this.config.animation==="smooth"){this.data.animation_frame=e.requestAnimationFrame(x,M.element,M)}else{var z=s%1*1e3;if(z<0)z=1e3+z;z+=50;M.data.animation_frame=e.setTimeout(function(){M.data.animation_frame=e.requestAnimationFrame(x,M.element,M)},z)}};b.prototype.animateArc=function(t,a,s,r,n,o){if(this.data.attributes.context===null)return;var f=n-r;if(Math.abs(f)>.5){if(r===0){this.radialFade(t,a,s,1)}else{this.radialFade(t,a,s,0)}}else{var u=(i-(o-new Date().getTime()))/i;if(u>1)u=1;var h=n*(1-u)+r*u;this.drawArc(t,a,s,h);if(u>=1)return;var d=this;e.requestAnimationFrame(function(){d.animateArc(t,a,s,r,n,o)},this.element)}};b.prototype.drawArc=function(t,e,i,s){if(this.data.attributes.context===null)return;var r=Math.max(this.data.attributes.outer_radius,this.data.attributes.item_size/2);if(!a){this.data.attributes.context.clearRect(t-r,e-r,r*2,r*2)}if(this.config.use_background){this.data.attributes.context.beginPath();this.data.attributes.context.arc(t,e,this.data.attributes.radius,0,2*Math.PI,false);this.data.attributes.context.lineWidth=this.data.attributes.line_width*this.config.bg_width;this.data.attributes.context.strokeStyle=this.config.circle_bg_color;this.data.attributes.context.stroke()}var n,o,f;var u=-.5*Math.PI;var h=2*Math.PI;n=u+this.config.start_angle/360*h;var d=2*s*Math.PI;if(this.config.direction==="Both"){f=false;n-=d/2;o=n+d}else{if(this.config.direction==="Clockwise"){f=false;o=n+d}else{f=true;o=n-d}}this.data.attributes.context.beginPath();this.data.attributes.context.arc(t,e,this.data.attributes.radius,n,o,f);this.data.attributes.context.lineWidth=this.data.attributes.line_width;this.data.attributes.context.strokeStyle=i;this.data.attributes.context.stroke()};b.prototype.radialFade=function(t,a,i,s,r){var n=u(i);var o=this;var f=.2*(s===1?-1:1);var h;for(h=0;s<=1&&s>=0;h++){(function(){var i=50*h;var r="rgba("+n.r+", "+n.g+", "+n.b+", "+Math.round(s*10)/10+")";e.setTimeout(function(){o.drawArc(t,a,r,1)},i)})();s+=f}if(typeof r!==undefined){e.setTimeout(function(){o.data.state.fading[r]=false},50*h)}};b.prototype.timeLeft=function(){if(this.data.paused&&typeof this.data.timer==="number"){return this.data.timer}var t=new Date;return(this.data.attributes.ref_date-t)/1e3};b.prototype.start=function(){e.cancelAnimationFrame(this.data.animation_frame);e.clearTimeout(this.data.animation_frame);var a=t(this.element).data("date");if(typeof a==="undefined"){a=t(this.element).attr("data-date")}if(typeof a==="string"){this.data.attributes.ref_date=c(a)}else if(typeof this.data.timer==="number"){if(this.data.paused){this.data.attributes.ref_date=new Date().getTime()+this.data.timer*1e3}}else{var i=t(this.element).data("timer");if(typeof i==="undefined"){i=t(this.element).attr("data-timer")}if(typeof i==="string"){i=parseFloat(i)}if(typeof i==="number"){this.data.timer=i;this.data.attributes.ref_date=new Date().getTime()+i*1e3}else{this.data.attributes.ref_date=this.config.ref_date}}this.data.paused=false;this.update.call(this)};b.prototype.restart=function(){this.data.timer=false;this.start()};b.prototype.stop=function(){if(typeof this.data.timer==="number"){this.data.timer=this.timeLeft(this)}this.data.paused=true;e.cancelAnimationFrame(this.data.animation_frame)};b.prototype.destroy=function(){this.clearListeners();this.stop();e.clearInterval(this.data.interval_fallback);this.data.interval_fallback=null;this.container.remove();t(this.element).removeAttr("data-tc-id");t(this.element).removeData("tc-id")};b.prototype.setOptions=function(a){if(this.config===null){this.default_options.ref_date=new Date;this.config=t.extend(true,{},this.default_options)}t.extend(true,this.config,a);if(this.config.use_top_frame){e=window.top}else{e=window}v();this.data.total_duration=this.config.total_duration;if(typeof this.data.total_duration==="string"){if(typeof f[this.data.total_duration]!=="undefined"){this.data.total_duration=f[this.data.total_duration]}else if(this.data.total_duration==="Auto"){for(var i=0;i<Object.keys(this.config.time).length;i++){var s=Object.keys(this.config.time)[i];if(this.config.time[s].show){this.data.total_duration=f[o[s]];break}}}else{this.data.total_duration=f["Years"];console.error("Valid values for TimeCircles config.total_duration are either numeric, or (string) Years, Months, Days, Hours, Minutes, Auto")}}};b.prototype.addListener=function(t,e,a){if(typeof t!=="function")return;if(typeof a==="undefined")a="visible";this.listeners[a].push({func:t,scope:e})};b.prototype.notifyListeners=function(t,e,a,i){for(var s=0;s<this.listeners[i].length;s++){var r=this.listeners[i][s];r.func.apply(r.scope,[t,e,a])}};b.prototype.default_options={ref_date:new Date,start:true,animation:"smooth",count_past_zero:true,circle_bg_color:"#60686F",use_background:true,fg_width:.1,bg_width:1.2,text_size:.07,number_size:.28,total_duration:"Auto",direction:"Clockwise",use_top_frame:false,start_angle:0,time:{Days:{show:true,text:"Days",color:"#FC6"},Hours:{show:true,text:"Hours",color:"#9CF"},Minutes:{show:true,text:"Minutes",color:"#BFB"},Seconds:{show:true,text:"Seconds",color:"#F99"}}};var g=function(t,e){this.elements=t;this.options=e;this.foreach()};g.prototype.getInstance=function(e){var a;var i=t(e).data("tc-id");if(typeof i==="undefined"){i=l();t(e).attr("data-tc-id",i)}if(typeof p[i]==="undefined"){var s=this.options;var r=t(e).data("options");if(typeof r==="string"){r=JSON.parse(r)}if(typeof r==="object"){s=t.extend(true,{},this.options,r)}a=new b(e,s);p[i]=a}else{a=p[i];if(typeof this.options!=="undefined"){a.setOptions(this.options)}}return a};g.prototype.addTime=function(t){this.foreach(function(e){e.addTime(t)})};g.prototype.foreach=function(t){var e=this;this.elements.each(function(){var a=e.getInstance(this);if(typeof t==="function"){t(a)}});return this};g.prototype.start=function(){this.foreach(function(t){t.start()});return this};g.prototype.stop=function(){this.foreach(function(t){t.stop()});return this};g.prototype.restart=function(){this.foreach(function(t){t.restart()});return this};g.prototype.rebuild=function(){this.foreach(function(t){t.initialize(false)});return this};g.prototype.getTime=function(){return this.getInstance(this.elements[0]).timeLeft()};g.prototype.addListener=function(t,e){if(typeof e==="undefined")e="visible";var a=this;this.foreach(function(i){i.addListener(t,a.elements,e)});return this};g.prototype.destroy=function(){this.foreach(function(t){t.destroy()});return this};g.prototype.end=function(){return this.elements};t.fn.TimeCircles=function(t){return new g(this,t)}})(jQuery);